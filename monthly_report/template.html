<h1>Monthly Status Report</h1>

<p><strong>Month:</strong> {{ month }}</p>
<p><strong>Year:</strong> {{ year }}</p>

<h2>Key Achievements</h2>
{% for category, achievements in achievements.items() %}
  <h3>{{ category }}</h3>
  <ul>
    {% for achievement in achievements %}
      <li>{{ achievement }}</li>
    {% endfor %}
  </ul>
{% endfor %}

<h2>Challenges</h2>
{% for category, challenges in challenges.items() %}
  <h3>{{ category }}</h3>
  <ul>
    {% for challenge in challenges %}
      <li>{{ challenge }}</li>
    {% endfor %}
  </ul>
{% endfor %}

<h2>Planned Efforts</h2>
{% for effort in roadmap %}
  {% if effort.start_date|date >= data.now|date and effort.start_date|date <= data.thirty_days|date %}
    <h3>Next 30 Days</h3>
    <ul>
      <li>
        <strong>{{ effort.description }}</strong>
        <p>Start Date: {{ effort.start_date }}</p>
        <p>Planned Completion Date: {{ effort.planned_completion_date }}</p>
        <h4>Steps:</h4>
        <ul>
          {% for step in effort.steps %}
            <li>
              <strong>{{ step.description }}</strong>
              <p>Start Date: {{ step.start_date }}</p>
              <p>Planned Completion Date: {{ step.planned_completion_date }}</p>
            </li>
          {% endfor %}
        </ul>
      </li>
    </ul>
  {% endif %}
  {% if effort.start_date|date >= data.thirty_days|date and effort.start_date|date <= data.sixty_days|date %}
    <h3>Next 60 Days</h3>
    <ul>
      <li>
        <strong>{{ effort.description }}</strong>
        <p>Start Date: {{ effort.start_date }}</p>
        <p>Planned Completion Date: {{ effort.planned_completion_date }}</p>
        <h4>Steps:</h4>
        <ul>
          {% for step in effort.steps %}
            <li>
              <strong>{{ step.description }}</strong>
              <p>Start Date: {{ step.start_date }}</p>
              <p>Planned Completion Date: {{ step.planned_completion_date }}</p>
            </li>
          {% endfor %}
        </ul>
      </li>
    </ul>
  {% endif %}
  {% if effort.start_date|date >= data.sixty_days|date and effort.start_date|date <= data.ninety_days|date %}
    <h3>Next 90 Days</h3>
    <ul>
      <li>
        <strong>{{ effort.description }}</strong>
        <p>Start Date: {{ effort.start_date }}</p>
        <p>Planned Completion Date: {{ effort.planned_completion_date }}</p>
        <h4>Steps:</h4>
        <ul>
          {% for step in effort.steps %}
            <li>
              <strong>{{ step.description }}</strong>
              <p>Start Date: {{ step.start_date }}</p>
              <p>Planned Completion Date: {{ step.planned_completion_date }}</p>
            </li>
          {% endfor %}
        </ul>
      </li>
    </ul>
  {% endif %}
{% endfor %}

<h2>Financials</h2>
<p>Planned Expenditures: {{ planned_expenditures }}</p>
<p>Actual Expenditures: {{ actual_expenditures }}</p>
<div>
  <canvas id="financialChart" width="400" height="200"></canvas>
  <script>
    var ctx = document.getElementById('financialChart').getContext('2d');
    var chart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: [
          {% for account in financials.accounts %}
            '{{ account.account_name }}',
          {% endfor %}
        ],
        datasets: [{
          label: 'Planned Expenditures',
          data: [
            {% for account in financials.accounts %}
              {{ account.expected_expenditures | sum(attribute='amount') }},
            {% endfor %}
          ],
          backgroundColor: 'rgba(255, 99, 132, 0.2)',
          borderColor: 'rgba(255, 99, 132, 1)',
          borderWidth: 1
        }, {
          label: 'Actual Expenditures',
          data: [
            {% for account in financials.accounts %}
              {{ account.actual_expenditures | sum(attribute='amount') }},
            {% endfor %}
          ],
          backgroundColor: 'rgba(54, 162, 235, 0.2)',
          borderColor: 'rgba(54, 162, 235, 1)',
          borderWidth: 1
        }]
      },
      options: {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        }
      }
    });
  </script>
</div>

<h2>Risk Tracker</h2>
<ul>
  {% for risk in risks %}
    <li>
      <strong>{{ risk.description }}</strong>
      <p>Likelihood: {{ risk.likelihood }}</p>
      <p>Impact: {{ risk.impact }}</p>
      <p>Mitigation Plan: {{ risk.mitigation_plan }}</p>
      <p>Expected Effect of Mitigation Plan: {{ risk.expected_effect }}</p>
    </li>
  {% endfor %}
</ul>
